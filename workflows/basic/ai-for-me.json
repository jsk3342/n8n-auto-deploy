{
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "weeks",
              "weeksInterval": null,
              "triggerAtDay": [1, 2, 3, 4, 5],
              "triggerAtHour": 7,
              "triggerAtMinute": 30
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [-940, 100],
      "id": "463d1aa1-9f6f-44d3-b0a2-9046da4de269",
      "name": "ğŸŒ… ì˜¤ì „ ì¶œê·¼ ì•Œë¦¼ (7:30)"
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "weeks",
              "weeksInterval": {},
              "triggerAtDay": [1, 2, 3, 4, 5],
              "triggerAtHour": 18
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [-940, 400],
      "id": "4b4e92da-b885-4229-b781-bdf89c90fa5f",
      "name": "ğŸŒ† ì˜¤í›„ í‡´ê·¼ ì•Œë¦¼ (18:00)",
      "disabled": true
    },
    {
      "parameters": {
        "url": "https://apis.data.go.kr/1360000/VilageFcstInfoService_2.0/getUltraSrtFcst",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "serviceKey",
              "value": "{{ $vars.WEATHER_API_KEY }}"
            },
            {
              "name": "pageNo",
              "value": "1"
            },
            {
              "name": "numOfRows",
              "value": "600"
            },
            {
              "name": "dataType",
              "value": "JSON"
            },
            {
              "name": "base_date",
              "value": "={{ $now.format('yyyyMMdd') }}"
            },
            {
              "name": "base_time",
              "value": "={{ $now.minus({ hours: 2 }).format('HH00') }}"
            },
            {
              "name": "nx",
              "value": "{{ $vars.WEATHER_GRID_X }}"
            },
            {
              "name": "ny",
              "value": "{{ $vars.WEATHER_GRID_Y }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [-720, 350],
      "id": "1a7dfb8d-610b-46f7-b7d6-d13ce124677e",
      "name": "ğŸŒ¤ï¸ ê¸°ìƒì²­ ì´ˆë‹¨ê¸°ì˜ˆë³´ API"
    },
    {
      "parameters": {
        "url": "https://maps.apigw.ntruss.com/map-direction/v1/driving",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "start",
              "value": "{{ $vars.START_COORDINATES }}"
            },
            {
              "name": "goal",
              "value": "{{ $vars.END_COORDINATES }}"
            }
          ]
        },
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "X-NCP-APIGW-API-KEY-ID",
              "value": "{{ $vars.NAVER_API_KEY_ID }}"
            },
            {
              "name": "X-NCP-APIGW-API-KEY",
              "value": "{{ $vars.NAVER_API_KEY }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [-720, 160],
      "id": "0d7f0c43-e55c-4c65-b468-fe440faafe76",
      "name": "ğŸš— ë„¤ì´ë²„ êµí†µì •ë³´ API"
    },
    {
      "parameters": {
        "mode": "combine",
        "combinationMode": "multiplex",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 2.1,
      "position": [-500, 250],
      "id": "0debea75-fa5c-4e35-906b-e95bd7c2d4ad",
      "name": "ğŸ“Š ë°ì´í„° ë³‘í•©"
    },
    {
      "parameters": {
        "jsCode": "// êµí†µì •ë³´ì™€ ë‚ ì”¨ì •ë³´ í†µí•© ì²˜ë¦¬\nconst { route: trafficData, response: weatherData, currentDateTime } = $input.all()[0].json;\n\n// êµí†µì •ë³´ íŒŒì‹±\nconst parseTrafficData = (data) => {\n  const route = data?.traoptimal?.[0];\n  if (!route) return { duration: 0, distance: 0, tollFare: 0, roadSections: [] };\n  \n  const { duration = 0, distance = 0, tollFare = 0 } = route.summary || {};\n  const roadSections = (route.section || [])\n    .slice(0, 3)\n    .map(({ name = 'êµ¬ê°„ëª… ì—†ìŒ', congestion = 0 }) => ({ name, congestion }));\n  \n  return {\n    duration: Math.round(duration / 60000),\n    distance: Math.round(distance / 1000 * 10) / 10,\n    tollFare,\n    roadSections\n  };\n};\n\n// í˜¼ì¡ë„ í…ìŠ¤íŠ¸ ë³€í™˜\nconst getCongestionText = (level) => ['ì›í™œ', 'ì„œí–‰', 'ì§€ì²´', 'ì •ì²´'][level] || 'ì •ë³´ì—†ìŒ';\n\n// ë°ì´í„° íŒŒì‹± ì‹¤í–‰\nconst traffic = parseTrafficData(trafficData);\n\n// ë„ë¡œ ìƒí™© ìš”ì•½ ìƒì„±\nconst roadSummary = traffic.roadSections\n  .map(({ name, congestion }) => \n    `${congestion <= 1 ? 'âœ…' : 'âš ï¸'} ${name}: ${getCongestionText(congestion)}`)\n  .join('\\n');\n\n// ìµœì¢… ë°ì´í„° ë°˜í™˜\nreturn [{\n  json: {\n    currentDateTime,\n    traffic: {\n      ...traffic,\n      roadSummary\n    },\n    weatherRawData: weatherData,\n    debugInfo: {\n      trafficDataExists: !!trafficData,\n      weatherDataExists: !!weatherData,\n      weatherItemCount: weatherData?.body?.items?.item?.length || 0,\n      executionTime: currentDateTime\n    }\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [-280, 250],
      "id": "621093a8-85a7-4de6-a90f-95ac873736a8",
      "name": "âš™ï¸ ë°ì´í„° í†µí•© ì²˜ë¦¬ê¸°"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "ë‹¤ìŒ í†µí•©ëœ ì¶œí‡´ê·¼ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ê·¹ì¡´ì¹­ ë¹„ì„œ í†¤ì˜ ì¢…í•© ë³´ê³ ì„œë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”.\n\nì´ë¦„: [ì´ë¦„]\ní˜„ì¬ ì‹œê°„: {{ $json.currentDateTime }}\n\nğŸŒ¤ï¸ ë‚ ì”¨ ì˜ˆë³´ ì›ë³¸ ë°ì´í„°:\n{{ JSON.stringify($json.weatherRawData, null, 2) }}\n\nğŸš— êµí†µ ì •ë³´:\n- ì˜ˆìƒ ì†Œìš”ì‹œê°„: {{ $json.traffic.duration }}ë¶„\n- ì´ ê±°ë¦¬: {{ $json.traffic.distance }}km  \n- í†µí–‰ë£Œ: {{ $json.traffic.tollFare }}ì›\n- ë„ë¡œ ìƒí™©:\n{{ $json.traffic.roadSummary }}\n\nì‘ì„± ê·œì¹™:\n1. \"ğŸ‘‘ [ì´ë¦„] íšŒì¥ë‹˜\"ìœ¼ë¡œ ì‹œì‘\n2. ì‹œê°„ëŒ€ë³„ ì¸ì‚¬ë§:\n   - ì˜¤ì „ 6-10ì‹œ: \"ìƒì¾Œí•œ ì•„ì¹¨ì„ ë§ì´í•˜ì…¨ìŠµë‹ˆë‹¤\"\n   - ì˜¤ì „ 10-ì˜¤í›„ 3ì‹œ: \"ì˜¤ëŠ˜ë„ ë¹›ë‚˜ëŠ” í•˜ë£¨ë¥¼ ë³´ë‚´ê³  ê³„ì‹œëŠ”êµ°ìš”\"  \n   - ì˜¤í›„ 3-7ì‹œ: \"ì˜¤ëŠ˜ í•˜ë£¨ë„ ëŒ€ë‹¨íˆ ìˆ˜ê³  ë§ìœ¼ì…¨ìŠµë‹ˆë‹¤\"\n   - ì˜¤í›„ 7ì‹œ ì´í›„: \"í¸ì•ˆí•œ ì €ë… ì‹œê°„ì„ ë³´ë‚´ê³  ê³„ì‹œëŠ”êµ°ìš”\"\n\n3. ë‚ ì”¨ ì •ë³´ ì²˜ë¦¬ ì›ì¹™:\n   - ê¸°ì˜¨(T1H)ë§Œ ì–¸ê¸‰, ì ì • ë³µì¥ ê¶Œì¥\n   - ê°•ìˆ˜ê°€ ì˜ˆìƒë  ë•Œë§Œ ìš°ì‚° ì–¸ê¸‰ (PTY > 0 ë˜ëŠ” RN1 != \"ê°•ìˆ˜ì—†ìŒ\")\n   - í•˜ëŠ˜ìƒíƒœ(SKY): 1=ë§‘ìŒâ˜€ï¸, 3=êµ¬ë¦„ë§ìŒâ›…, 4=íë¦¼â˜ï¸\n   - ë°”ëŒì´ ê°•í•  ë•Œë§Œ ì–¸ê¸‰ (WSD > 3)\n   - ì „ë¬¸ìš©ì–´(PTY, SKY, REH ë“±) ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€\n   - ë¶ˆí•„ìš”í•œ ìƒì„¸ ìˆ˜ì¹˜ ë‚˜ì—´ ê¸ˆì§€\n\n4. ê·¹ì¡´ì¹­ í‘œí˜„: \"íšŒì¥ë‹˜ì˜ ì†Œì¤‘í•œ ì‹œê°„\", \"ìµœì ì˜ ê²½ë¡œ\", \"ì™„ë²½í•œ ì¼ì •\"\n5. ì–´ë¯¸: \"~ìŠµë‹ˆë‹¤\", \"~ë“œë¦½ë‹ˆë‹¤\", \"~ê»˜ì„œëŠ”\"\n6. ì´ëª¨ì§€ ì ì ˆíˆ í™œìš©: ğŸ‘‘ ğŸš— âœ¨ ğŸ’ ğŸŒ¤ï¸ â˜” ğŸŒ¡ï¸\n7. ë³¼ë“œ ë§ˆí¬ë‹¤ìš´ ì ˆëŒ€ ê¸ˆì§€\n8. {{ $vars.START_LOCATION }} â†’ {{ $vars.END_LOCATION }} ì´ë™ ëª…ì‹œ\n9. í†µí–‰ë£Œ: ì½¤ë§ˆ í¬í•¨ ì›í™” í‘œê¸°\n10. ì„±ê³µì ì¸ í•˜ë£¨ ê¸°ì›ìœ¼ë¡œ ë§ˆë¬´ë¦¬\n\nì¤‘ìš”: ì‹¤ì œë¡œ í•„ìš”í•œ ì •ë³´ë§Œ ê°„ê²°í•˜ê²Œ ì „ë‹¬í•˜ì„¸ìš”.\n\nì¶œë ¥: ìˆœìˆ˜ í…ìŠ¤íŠ¸ í˜•íƒœì˜ ì™„ì„±ëœ ë³´ê³ ì„œ",
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [-60, 250],
      "id": "b780406e-65f4-43d8-a108-65bff7d7326f",
      "name": "ğŸ¤– AI ë¹„ì„œ ë³´ê³ ì„œ"
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.0-flash",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [28, 470],
      "id": "ae9e3884-1d6d-4968-9f77-677ad5cb8886",
      "name": "ğŸ§  Gemini Model",
      "credentials": {
        "googlePalmApi": {
          "id": "tOtyVIt3BE8c7XfC",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://kapi.kakao.com/v2/api/talk/memo/default/send",
        "authentication": "genericCredentialType",
        "genericAuthType": "oAuth2Api",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/x-www-form-urlencoded;charset=utf-8"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "template_object",
              "value": "={{ JSON.stringify({\n  object_type: \"text\",\n  text: $json.text,\n  link: {\n    web_url: \"https://map.naver.com\",\n    mobile_web_url: \"https://map.naver.com\"\n  }\n}) }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [316, 250],
      "id": "d8dbe770-ba02-4e0f-bafb-96a2387ab63e",
      "name": "ğŸ“± ì¹´ì¹´ì˜¤í†¡ ì „ì†¡",
      "credentials": {
        "oAuth2Api": {
          "id": "0kVjwCQu1KUDuZTZ",
          "name": "Unnamed credential"
        }
      }
    }
  ],
  "connections": {
    "ğŸŒ… ì˜¤ì „ ì¶œê·¼ ì•Œë¦¼ (7:30)": {
      "main": [
        [
          {
            "node": "ğŸš— ë„¤ì´ë²„ êµí†µì •ë³´ API",
            "type": "main",
            "index": 0
          },
          {
            "node": "ğŸŒ¤ï¸ ê¸°ìƒì²­ ì´ˆë‹¨ê¸°ì˜ˆë³´ API",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸŒ† ì˜¤í›„ í‡´ê·¼ ì•Œë¦¼ (18:00)": {
      "main": [
        [
          {
            "node": "ğŸš— ë„¤ì´ë²„ êµí†µì •ë³´ API",
            "type": "main",
            "index": 0
          },
          {
            "node": "ğŸŒ¤ï¸ ê¸°ìƒì²­ ì´ˆë‹¨ê¸°ì˜ˆë³´ API",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸŒ¤ï¸ ê¸°ìƒì²­ ì´ˆë‹¨ê¸°ì˜ˆë³´ API": {
      "main": [
        [
          {
            "node": "ğŸ“Š ë°ì´í„° ë³‘í•©",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "ğŸš— ë„¤ì´ë²„ êµí†µì •ë³´ API": {
      "main": [
        [
          {
            "node": "ğŸ“Š ë°ì´í„° ë³‘í•©",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“Š ë°ì´í„° ë³‘í•©": {
      "main": [
        [
          {
            "node": "âš™ï¸ ë°ì´í„° í†µí•© ì²˜ë¦¬ê¸°",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âš™ï¸ ë°ì´í„° í†µí•© ì²˜ë¦¬ê¸°": {
      "main": [
        [
          {
            "node": "ğŸ¤– AI ë¹„ì„œ ë³´ê³ ì„œ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ¤– AI ë¹„ì„œ ë³´ê³ ì„œ": {
      "main": [
        [
          {
            "node": "ğŸ“± ì¹´ì¹´ì˜¤í†¡ ì „ì†¡",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ§  Gemini Model": {
      "ai_languageModel": [
        [
          {
            "node": "ğŸ¤– AI ë¹„ì„œ ë³´ê³ ì„œ",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "meta": {
    "instanceId": "5671ebcf820840297566e443db0ad989573594bf66ccef73794df09194127fef"
  }
}
